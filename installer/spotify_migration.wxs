<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
   <Product Id="*" 
           Name="Spotify Data Migration" 
           Language="1033" 
           Version="1.0.0.0" 
           Manufacturer="Your Name" 
           UpgradeCode="38f8b5f1-114e-4b61-8c92-29a4ed3a3208">
      
      <Package InstallerVersion="200" Compressed="yes" InstallScope="perMachine" />
      
      <MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />
      <MediaTemplate EmbedCab="yes" />
      
      <Feature Id="ProductFeature" Title="Spotify Data Migration" Level="1">
         <ComponentGroupRef Id="ProductComponents" />
         <ComponentRef Id="ApplicationShortcut" />
      </Feature>
      
      <Directory Id="TARGETDIR" Name="SourceDir">
         <Directory Id="ProgramFilesFolder">
            <Directory Id="INSTALLFOLDER" Name="Spotify Data Migration" />
         </Directory>
         <Directory Id="ProgramMenuFolder">
            <Directory Id="ApplicationProgramsFolder" Name="Spotify Data Migration" />
         </Directory>
         <Directory Id="DesktopFolder" Name="Desktop" />
      </Directory>
      
      <ComponentGroup Id="ProductComponents" Directory="INSTALLFOLDER">
         <!-- Include all files from your application folder -->
         <Component Id="ProductComponent" Guid="*">
            <File Id="SpotifyDataMigrationEXE" 
                  Source="..\dist\SpotifyDataMigration\SpotifyDataMigration.exe" 
                  KeyPath="yes" />
            
            <!-- Include all other files recursively -->
            <!-- This is simplistic, in practice you need to list all files -->
            <!-- <File Id="File1" Source="..\dist\SpotifyDataMigration\[filename]" /> -->
         </Component>
      </ComponentGroup>
      
      <DirectoryRef Id="ApplicationProgramsFolder">
         <Component Id="ApplicationShortcut" Guid="*">
            <Shortcut Id="ApplicationStartMenuShortcut" 
                      Name="Spotify Data Migration" 
                      Description="Tool to migrate Spotify playlists between accounts"
                      Target="[INSTALLFOLDER]SpotifyDataMigration.exe"
                      WorkingDirectory="INSTALLFOLDER" />
            <RemoveFolder Id="RemoveApplicationProgramsFolder" On="uninstall" />
            <RegistryValue Root="HKCU" Key="Software\YourName\SpotifyDataMigration" 
                           Name="installed" Type="integer" Value="1" KeyPath="yes" />
         </Component>
      </DirectoryRef>
   </Product>
</Wix>
